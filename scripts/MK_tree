local my_script={};local tab=Menu.Create("Heroes","Hero List","Monkey King");local group=tab:Create("Main Settings"):Create("Auto Primal Spring");local ui={};ui.global_switch=group:Switch("Включить скрипт",false,"\u{f011}");ui.extra_logic_switch=group:Switch("Ставить ветку",true,"\u{f06e}");ui.extra_logic_switch:ToolTip("Если рядом нету дерева, поставит ветку и отпрыгнет от нее.");ui.hotkey=group:Bind("Bind",Enum.ButtonCode.KEY_NONE,"\u{f11c}");local function on_global_switch_change()local is_enabled=ui.global_switch:Get();ui.hotkey:Disabled(not is_enabled);ui.extra_logic_switch:Disabled(not is_enabled)end;ui.global_switch:SetCallback(on_global_switch_change,true);local my_hero=nil;local local_player=nil;local last_action_time=0;local ACTION_COOLDOWN=0.01;local function find_closest_tree(hero_pos,trees)local closest_tree=nil;local min_dist=-1;for _,tree in ipairs(trees)do local dist=hero_pos:Distance(Entity.GetAbsOrigin(tree));if min_dist==-1 or dist<min_dist then min_dist=dist;closest_tree=tree end end;return closest_tree end;my_script.OnUpdate=function()if not ui.global_switch:Get()then return end;if not local_player then local_player=Players.GetLocal()end;if not local_player then return end;if not my_hero or not Entity.IsAlive(my_hero)or Entity.GetUnitName(my_hero)~="npc_dota_hero_monkey_king"then my_hero=Heroes.GetLocal();if not my_hero or Entity.GetUnitName(my_hero)~="npc_dota_hero_monkey_king"then my_hero=nil;return end end;local assigned_key=ui.hotkey:Get();if assigned_key==Enum.ButtonCode.KEY_NONE or not Input.IsKeyDown(assigned_key)then return end;local primal_spring=NPC.GetAbility(my_hero,"monkey_king_primal_spring");if not primal_spring or not Ability.IsReady(primal_spring)then return end;if GameRules.GetGameTime()<last_action_time+ACTION_COOLDOWN then return end;if NPC.HasModifier(my_hero,"modifier_monkey_king_tree_dance_hidden")then local cursor_pos=Input.GetWorldCursorPos();Player.PrepareUnitOrders(local_player,Enum.UnitOrder.DOTA_UNIT_ORDER_CAST_POSITION,nil,cursor_pos,primal_spring,Enum.PlayerOrderIssuer.DOTA_ORDER_ISSUER_PASSED_UNIT_ONLY,my_hero);Player.PrepareUnitOrders(local_player,Enum.UnitOrder.DOTA_UNIT_ORDER_HOLD_POSITION,nil,nil,nil,Enum.PlayerOrderIssuer.DOTA_ORDER_ISSUER_SELECTED_UNITS,my_hero,false,true);last_action_time=GameRules.GetGameTime()else local tree_dance=NPC.GetAbility(my_hero,"monkey_king_tree_dance");if not tree_dance or not Ability.IsReady(tree_dance)then return end;local cast_range=Ability.GetCastRange(tree_dance);local all_trees={};for _,tree in ipairs(Entity.GetTreesInRadius(my_hero,cast_range,true))do table.insert(all_trees,tree)end;for _,tree in ipairs(Entity.GetTempTreesInRadius(my_hero,cast_range))do table.insert(all_trees,tree)end;local nearest_tree=find_closest_tree(Entity.GetAbsOrigin(my_hero),all_trees);if nearest_tree then Player.PrepareUnitOrders(local_player,Enum.UnitOrder.DOTA_UNIT_ORDER_CAST_TARGET_TREE,nearest_tree,nil,tree_dance,Enum.PlayerOrderIssuer.DOTA_ORDER_ISSUER_HERO_ONLY,my_hero);last_action_time=GameRules.GetGameTime()elseif ui.extra_logic_switch:Get()then local iron_branch=NPC.GetItem(my_hero,"item_branches",false);if iron_branch and Ability.IsReady(iron_branch)then local plant_pos=Entity.GetForwardPosition(my_hero,150);Player.PrepareUnitOrders(local_player,Enum.UnitOrder.DOTA_UNIT_ORDER_CAST_POSITION,nil,plant_pos,iron_branch,Enum.PlayerOrderIssuer.DOTA_ORDER_ISSUER_PASSED_UNIT_ONLY,my_hero,false,true);last_action_time=GameRules.GetGameTime()end end end end;my_script.OnGameEnd=function()my_hero=nil;local_player=nil;last_action_time=0 end;return my_script

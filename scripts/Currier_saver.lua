---@diagnostic disable: undefined-global, param-type-mismatch, inject-field
local _a={}local _b={}local _c=Menu.Create("Miscellaneous","In Game","Courier")local _d=_c:Create("Main"):Create("Courier")_b.e=_d:Switch("Включить авто-отступление курьера",true,"\u{f542}")_b.s=_d:Switch("Включить 'Умный побег'",true)local _C1=1200 local _C2={[Enum.TeamNum.TEAM_RADIANT]=Vector(-7019,-6534,384),[Enum.TeamNum.TEAM_DIRE]=Vector(6846,6251,384)}local _e={escape_data={}}_a.OnUpdate=function()if not _b.e:Get()then return end local _v1,_v2=Players.GetLocal(),Heroes.GetLocal()local _v3=Couriers.GetLocal()if not _v1 or not _v2 or not _v3 or not Entity.IsAlive(_v3)then return end local _v4=Entity.GetIndex(_v3)if _e.escape_data[_v4]then local _v5=_e.escape_data[_v4]local _v6=Entity.GetAbsOrigin(_v3)if(_v6-_v5.dest):Length()<100 then Chat.Print("ConsoleChat","<font color='#42f560'>[Courier Saver]</font> Курьер в безопасности. Можно отдавать новый приказ.")_e.escape_data[_v4]=nil return end if GlobalVars.GetCurTime()>_v5.time+6.5 then Chat.Print("ConsoleChat","<font color='#f5e942'>[Courier Saver]</font> Курьер, вероятно, застрял. Можно отдавать новый приказ.")_e.escape_data[_v4]=nil return end return end local _v7=Courier.GetCourierState(_v3)if _v7==Enum.CourierState.COURIER_STATE_AT_BASE or _v7==Enum.CourierState.COURIER_STATE_IDLE then return end local _v6=Entity.GetAbsOrigin(_v3)local _v8=Entity.GetTeamNum(_v3)local _v9=NPCs.InRadius(_v6,_C1,_v8,Enum.TeamType.TEAM_ENEMY)for _,_v10 in ipairs(_v9)do if Entity.IsHero(_v10)and not NPC.IsIllusion(_v10)and Entity.IsAlive(_v10)then local _v11=NPC.GetAttackRange(_v10)+NPC.GetHullRadius(_v10)if not NPC.IsRanged(_v10)then _v11=_v11+330 else _v11=_v11+260 end if(_v6-Entity.GetAbsOrigin(_v10)):Length()<=_v11 then local _v12 if _b.s:Get()then local _v13=(_v6-Entity.GetAbsOrigin(_v10)):Normalized()_v12=_v6+_v13*1500 else _v12=_C2[_v8]end if _v12 then Player.PrepareUnitOrders(_v1,Enum.UnitOrder.DOTA_UNIT_ORDER_MOVE_TO_POSITION,nil,_v12,nil,Enum.PlayerOrderIssuer.DOTA_ORDER_ISSUER_PASSED_UNIT_ONLY,_v3)_e.escape_data[_v4]={dest=_v12,time=GlobalVars.GetCurTime()}end return end end end end _a.OnPrepareUnitOrders=function(_p1)local _v3=Couriers.GetLocal()if not _v3 or not _p1.npc or not Entity.IsEntity(_p1.npc)then return true end if Entity.GetIndex(_p1.npc)==Entity.GetIndex(_v3)then local _v4=Entity.GetIndex(_v3)if _e.escape_data[_v4]then _e.escape_data[_v4]=nil end end return true end _a.OnGameEnd=function()_e.escape_data={}end return _a